数据链路层使用“物理层”提供的“比特传输”服务  
数据链路层为网络层提供服务，将网络层的IP数据报（分组）封装成帧，传输给下一个相邻节点    
**物理链路**：传输介质（0层）+物理层（1层）实现了相邻节点之间的“物理链路”  
**逻辑链路**：数据链路层需要基于“物理链路”，实现相邻结点之间逻辑上无差错的“数据链路”  
---
# 功能
+ 封装成帧：
	+ 帧定界：如何让接收方能够确定帧的界限
	+ 透明传输：接收方链路层要能从收到的帧内恢复原始SDU，让网络层“感受不到”将分组封装成帧的过程
+ 差错控制：发现并解决一个帧内部的“位错”
	+ 解决方案一：接收方发现比特错后丢弃帧，发送方重传帧（仅需采用检错编码）
	+ 解决方案二：由接收方发现并纠正比特错误（需采用纠错编码）
+ 可靠传输：发现并解决“帧错”（帧丢失、帧重复、帧失序）
+ 流量控制：控制发送方发送帧的速率别太快，让接收方“来得及”接受
+ 介质访问控制：
	+ “广播信道”需要实现此功能。广播信道在逻辑上是总线型拓扑，多个结点需争抢传输介质的使用权
	+ “点对点信道”通常不需要实现此功能。点对点信道通常意味着两个节点之间有专属介质，不用抢
---
# 组帧
+ 字符计数法：在每个帧开头，用一个定长计数字段表示帧长
	+ 缺点：任何一个技术字段出错，都会导致后续所有帧无法定界
+ 字节填充法：使用SOH和EOT控制字符表示一帧的开始与结束，通常会使用ESC转义字符避免帧中出现控制字符导致扫描出错。
+ 零比特填充法（HDLC、PPP）：使用比特串01111110来标志一帧的开始和结束
	+ 发送方需要对帧的数据部分进行处理，*每当遇到5个1，就填充一个0*
	+ 接收方需要对帧的数据部分进行逆处理，*每当遇到连续5个1，就删掉后面的0*
+ 违规编码法：需要物理层配合，对采用的信号传输方式使用违规的信号编码，例如基于曼彻斯特码，每一个信号是观察信号是否跳变，当信号不进行跳变时则“违规”，将其表示帧的开始或结束
---
# 差错控制
### 奇偶校验码
奇（偶）校验码：整个校验码（有效信息为何校验位）中“1”的个数为奇（偶）数    
奇校验：检查信息位中“1”的个数为偶数则校验位为1，为奇数则检验位为0（偶校验相反）  
偶校验的硬件实现：各信息进行异或运算，得到的结果即为偶校验位  
缺点：只能检测奇数位出现错误的情况，并且不知道哪些位出错
### 循环冗余码（CRC）
思想：数据发送、接收方约定为一个“除数”，K个信息位+R个校验位作为“被除数”，添加校验位后需保证出发的余数为0，然后接收方进行除法检测余数是否为0，非0即需要重传或者纠错  
基本思想：
1. 收发双方约定生成多项式G(x)（最高位和最低位必须为1），k位位串可视为阶数为k-1的多项式的系数序列。例如，可用多项式$x^3+x^2+1$表示位串1101
2. 发送方基于待发送的数据和G(x)，计算冗余码，将冗余码附加到数据后面一起发送
3. 接收方收到数据和冗余码后，通过G(x)来计算收到的数据和冗余码是否产生差错

检错能力：
+ 可检测出所有格奇数个错误
+ 可检测出所有双比特的错误
+ 可检测出所有小于等于检验位长度的连续错误
+ 若选择合适的生成多项式，且$2^R\geq K+R+1$,则可纠正单比特错误
### 海明校验码
1. 确定海明码位数：n为有效信息位数，k为校验位的位数，则信息位n和校验位k应满足$n+k+1\leq2^k-1$
2. 确定校验位的分布，校验位$P_i$放在海明位号为$2^{i-1}$的位置上，信息位按顺序放到其余位置
3. 分组以形成校验关系：被检验数据位的海明位号等于检验该数据位的各检验位海明位号之和
4. 检验位取值：检验位$P_i$的值为第i组所有位求异或
5. 构造校验方程：G1 = P1 ⊕ D1 ⊕ D2 ⊕ D4 ；G2 = P2 ⊕ D1 ⊕ D3 ⊕ D4；G3 = P3 ⊕ D2 ⊕ D3 ⊕ D4等，最后由“G3G2G1”的值进行判断，若为“000”，则正确，若为“001”，则第一位发生了错误

综上所述，海明码纠错能力只有1位，检错能力可以检错2位  
---